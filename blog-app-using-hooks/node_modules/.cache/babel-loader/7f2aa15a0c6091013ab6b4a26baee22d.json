{"ast":null,"code":"import _slicedToArray from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{Articles_URL,Local_Storage_Key}from'../utilities/constants';import Comments from'./Comments';import UserContext from'../context/UserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function CommentBox(props){var _info$data,_info$data$user;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),inputText=_useState2[0],setInputText=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComents=_useState4[1];var info=useContext(UserContext);var slug=props.slug;useEffect(function(){getComments(slug);},[slug]);function handleChange(_ref){var target=_ref.target;var value=target.value;setInputText(value);}function handleSubmit(event){event.preventDefault();var slug=props.slug;if(inputText){fetch(Articles_URL+'/'+slug+'/comments',{method:'POST',body:JSON.stringify({comment:{body:inputText}}),headers:{'Content-Type':'application/json',Authorization:'Bearer '+localStorage[Local_Storage_Key]}}).then(function(res){if(!res.ok){return res.json().then(function(_ref2){var errors=_ref2.errors;return Promise.reject(errors);});}return res.json();}).then(function(data){setInputText('');setComents('');getComments(slug);}).catch(function(err){return console.log(err);});}}function handleDelete(_ref3){var target=_ref3.target;var id=target.dataset.id;var slug=props.slug;fetch(Articles_URL+'/'+slug+'/comments/'+id,{method:'DELETE',headers:{Authorization:'Token '+localStorage[Local_Storage_Key]}}).then(function(res){if(!res.ok){return res.json().then(function(_ref4){var errors=_ref4.errors;return Promise.reject(errors);});}setComents('');getComments(slug);}).catch(function(err){return console.log(err);});}function getComments(slug){fetch(Articles_URL+'/'+slug+'/comments').then(function(res){if(!res.ok){return res.json().then(function(_ref5){var errors=_ref5.errors;return Promise.reject(errors);});}return res.json();}).then(function(_ref6){var comments=_ref6.comments;setComents(comments);}).catch(function(err){return console.log(err);});}var loggedInUser=(_info$data=info.data)===null||_info$data===void 0?void 0:(_info$data$user=_info$data.user)===null||_info$data$user===void 0?void 0:_info$data$user.username;return/*#__PURE__*/_jsxs(_Fragment,{children:[loggedInUser&&/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"my-6 flex flex-col w-1/3\",onSubmit:function onSubmit(e){return handleSubmit(e);},children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full border-2 border-gray-400 rounded-md p-3 outline-none focus:border-blue-500\",rows:\"3\",placeholder:\"Enter Comments\",value:inputText,onChange:function onChange(e){return handleChange(e);},name:\"inputText\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Add Comment\",className:\"px-2 py-1 shadow-md btn-primary self-end text-white text-xs rounded-md cursor-pointer hover:bg-blue-400 mt-5\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"my-8\",children:/*#__PURE__*/_jsx(Comments,{comments:comments,handleDelete:handleDelete})})]});}export default CommentBox;","map":{"version":3,"sources":["/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/src/components/CommentBox.js"],"names":["React","useState","useEffect","useContext","Articles_URL","Local_Storage_Key","Comments","UserContext","CommentBox","props","inputText","setInputText","comments","setComents","info","slug","getComments","handleChange","target","value","handleSubmit","event","preventDefault","fetch","method","body","JSON","stringify","comment","headers","Authorization","localStorage","then","res","ok","json","errors","Promise","reject","data","catch","err","console","log","handleDelete","id","dataset","loggedInUser","user","username","e"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { Articles_URL, Local_Storage_Key } from '../utilities/constants';\nimport Comments from './Comments';\nimport UserContext from '../context/UserContext';\n\nfunction CommentBox(props) {\n  const [inputText, setInputText] = useState('');\n  const [comments, setComents] = useState('');\n  const info = useContext(UserContext);\n  let slug = props.slug;\n\n  useEffect(() => {\n    getComments(slug);\n  }, [slug]);\n\n  function handleChange({ target }) {\n    let { value } = target;\n    setInputText(value);\n  }\n\n  function handleSubmit(event) {\n    event.preventDefault();\n    let slug = props.slug;\n    if (inputText) {\n      fetch(Articles_URL + '/' + slug + '/comments', {\n        method: 'POST',\n        body: JSON.stringify({ comment: { body: inputText } }),\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + localStorage[Local_Storage_Key],\n        },\n      })\n        .then((res) => {\n          if (!res.ok) {\n            return res.json().then(({ errors }) => {\n              return Promise.reject(errors);\n            });\n          }\n          return res.json();\n        })\n        .then((data) => {\n          setInputText('');\n          setComents('');\n          getComments(slug);\n        })\n        .catch((err) => console.log(err));\n    }\n  }\n\n  function handleDelete({ target }) {\n    let { id } = target.dataset;\n    let slug = props.slug;\n    fetch(Articles_URL + '/' + slug + '/comments/' + id, {\n      method: 'DELETE',\n      headers: {\n        Authorization: 'Token ' + localStorage[Local_Storage_Key],\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          return res.json().then(({ errors }) => {\n            return Promise.reject(errors);\n          });\n        }\n        setComents('');\n        getComments(slug);\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function getComments(slug) {\n    fetch(Articles_URL + '/' + slug + '/comments')\n      .then((res) => {\n        if (!res.ok) {\n          return res.json().then(({ errors }) => {\n            return Promise.reject(errors);\n          });\n        }\n        return res.json();\n      })\n      .then(({ comments }) => {\n        setComents(comments);\n      })\n      .catch((err) => console.log(err));\n  }\n\n  let loggedInUser = info.data?.user?.username;\n  return (\n    <>\n      {loggedInUser && (\n        <div className=\"\">\n          <form\n            className=\"my-6 flex flex-col w-1/3\"\n            onSubmit={(e) => handleSubmit(e)}\n          >\n            <textarea\n              className=\"w-full border-2 border-gray-400 rounded-md p-3 outline-none focus:border-blue-500\"\n              rows=\"3\"\n              placeholder=\"Enter Comments\"\n              value={inputText}\n              onChange={(e) => handleChange(e)}\n              name=\"inputText\"\n            ></textarea>\n            <input\n              type=\"submit\"\n              value=\"Add Comment\"\n              className=\"px-2 py-1 shadow-md btn-primary self-end text-white text-xs rounded-md cursor-pointer hover:bg-blue-400 mt-5\"\n            />\n          </form>\n        </div>\n      )}\n\n      <div className=\"my-8\">\n        <Comments comments={comments} handleDelete={handleDelete} />\n      </div>\n    </>\n  );\n}\n\nexport default CommentBox;\n"]},"metadata":{},"sourceType":"module"}