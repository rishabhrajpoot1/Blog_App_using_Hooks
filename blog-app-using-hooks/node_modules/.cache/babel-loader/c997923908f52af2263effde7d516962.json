{"ast":null,"code":"import _objectSpread from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import Loader from'./Loader';import{Articles_URL,Profile_URL,Local_Storage_Key}from'../utilities/constants';import Articles from'./Articles';import Pagination from'./Pagination';import{withRouter,Link}from'react-router-dom';import UserContext from'../context/UserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Profile(props){var _info$data,_info$data$user;var _useState=useState({user:'',articles:null,articlesCount:null,articlesPerPage:10,activePageIndex:1,feedSelected:'author',following:'',favoriteCount:0,error:''}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var info=useContext(UserContext);var id=props.match.params.id;useEffect(function(){function getUserInfo(id){fetch(Profile_URL+id,{method:'GET',headers:{Authorization:'Bearer '+localStorage[Local_Storage_Key]}}).then(function(res){if(!res.ok){return res.json().then(function(_ref){var errors=_ref.errors;return Promise.reject();});}return res.json();}).then(function(data){var profile=data.profile;setState(function(state){return _objectSpread(_objectSpread({},state),{},{user:profile,following:profile.following});});}).catch(function(err){return console.log(err);});}getUserInfo(id);},[id]);var feedUser=state.user.username;useEffect(function(){var offset=(state.activePageIndex-1)*10;var token=localStorage[Local_Storage_Key];if(feedUser){fetch(\"\".concat(Articles_URL,\"?\").concat(state.feedSelected,\"=\").concat(feedUser,\"&limit=\").concat(state.articlesPerPage,\"&offset=\").concat(offset),{method:'GET',headers:{Authorization:\"Bearer \".concat(token),'Content-type':'application/json'}}).then(function(res){if(!res.ok){throw new Error(res.statusText);}return res.json();}).then(function(data){setState(function(state){return _objectSpread(_objectSpread({},state),{},{articles:data.articles,articlesCount:data.articlesCount});});}).catch(function(err){setState(function(state){return _objectSpread(_objectSpread({},state),{},{error:'Not able to fetch Articles'});});});}},[feedUser,state.feedSelected,state.activePageIndex,state.articlesPerPage,state.favoriteCount]);function handleClick(_ref2){var target=_ref2.target;var id=target.dataset.id;setState(_objectSpread(_objectSpread({},state),{},{activePageIndex:id}));}function updateCurrentPageIndex(index){setState(_objectSpread(_objectSpread({},state),{},{activePageIndex:index}));}function handleFollow(){// getUserInfo();\nvar username=state.user.username;var following=state.following;var method=following?'DELETE':'POST';fetch(Profile_URL+'/'+username+'/follow',{method:method,headers:{Authorization:'Bearer '+localStorage[Local_Storage_Key]}}).then(function(res){if(!res.ok){return res.json().then(function(_ref3){var errors=_ref3.errors;return Promise.reject();});}return res.json();}).then(function(_ref4){var profile=_ref4.profile;// console.log(profile);\nsetState(_objectSpread(_objectSpread({},state),{},{following:profile.following}));}).catch(function(err){return console.log(err);});}function handleFavorite(_ref5){var target=_ref5.target;var _target$dataset=target.dataset,id=_target$dataset.id,slug=_target$dataset.slug,count=_target$dataset.count;var method=id==='false'?'POST':'DELETE';fetch(Articles_URL+'/'+slug+'/favorite',{method:method,headers:{Authorization:'Token '+localStorage[Local_Storage_Key]}}).then(function(res){if(!res.ok){return res.json().then(function(_ref6){var errors=_ref6.errors;return Promise.reject(errors);});}return res.json();}).then(function(data){// getFeedArticles();\nsetState(_objectSpread(_objectSpread({},state),{},{favoriteCount:count+1}));}).catch(function(err){return console.log(err);});}if(!state.user){return/*#__PURE__*/_jsx(Loader,{});}var _state$user=state.user,username=_state$user.username,image=_state$user.image,bio=_state$user.bio;// let loggedInUser = this.props?.user?.username;\nvar loggedInUser=(_info$data=info.data)===null||_info$data===void 0?void 0:(_info$data$user=_info$data.user)===null||_info$data$user===void 0?void 0:_info$data$user.username;var articles=state.articles,error=state.error,articlesCount=state.articlesCount,activePageIndex=state.activePageIndex,articlesPerPage=state.articlesPerPage,feedSelected=state.feedSelected,following=state.following;return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-200 text-white py-16 text-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:image,alt:username,className:\"w-40 h-40 rounded-full mx-auto\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-4xl my-4 text-gray-700\",children:username}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl text-gray-500 mb-5\",children:bio}),/*#__PURE__*/_jsxs(\"div\",{className:\"float-right mr-10 \",children:[loggedInUser&&loggedInUser!==username&&/*#__PURE__*/_jsxs(\"button\",{className:\"bg-gray-200 text-gray-700 btn rounded-full hover:bg-gray-300 transform transition duration-500 hover:scale-105\",onClick:handleFollow,children:[/*#__PURE__*/_jsx(\"i\",{className:!following?'fas fa-plus mr-2':'fas fa-minus mr-2'}),!following?'follow':'unfollow']}),loggedInUser&&loggedInUser===username&&/*#__PURE__*/_jsxs(Link,{to:\"/settings\",className:\"btn bg-gray-200 text-gray-600 hover:bg-gray-300\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-edit mr-2\"}),\"Edit Profile\"]})]})]}),/*#__PURE__*/_jsxs(\"article\",{className:\"px-40\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"py-6\",children:[/*#__PURE__*/_jsxs(\"span\",{className:feedSelected==='author'?'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500':'cursor-pointer text-xl text-gray-700',onClick:function onClick(){setState(_objectSpread(_objectSpread({},state),{},{feedSelected:'author',activePageIndex:1}));// getFeedArticles();\n},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-newspaper mr-2\"}),\"Articles written\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"mx-4\",children:\"/\"}),/*#__PURE__*/_jsxs(\"span\",{className:feedSelected==='favorited'?'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500':'cursor-pointer text-xl text-gray-700',onClick:function onClick(){setState(_objectSpread(_objectSpread({},state),{},{feedSelected:'favorited',activePageIndex:1}));// getFeedArticles();\n},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-newspaper mr-2\"}),\"Favorited\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(Articles,{articles:articles,error:error,isLoggedIn:info.data.isLoggedIn,handleFavorite:handleFavorite})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 flex justify-center\",children:/*#__PURE__*/_jsx(Pagination,{articlesCount:articlesCount,articlesPerPage:articlesPerPage,activePageIndex:activePageIndex,handleClick:handleClick,updateCurrentPageIndex:updateCurrentPageIndex})})]})});}export default withRouter(Profile);","map":{"version":3,"sources":["/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/src/components/Profile.js"],"names":["React","useState","useEffect","useContext","Loader","Articles_URL","Profile_URL","Local_Storage_Key","Articles","Pagination","withRouter","Link","UserContext","Profile","props","user","articles","articlesCount","articlesPerPage","activePageIndex","feedSelected","following","favoriteCount","error","state","setState","info","id","match","params","getUserInfo","fetch","method","headers","Authorization","localStorage","then","res","ok","json","errors","Promise","reject","data","profile","catch","err","console","log","feedUser","username","offset","token","Error","statusText","handleClick","target","dataset","updateCurrentPageIndex","index","handleFollow","handleFavorite","slug","count","image","bio","loggedInUser","isLoggedIn"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport Loader from './Loader';\nimport {\n  Articles_URL,\n  Profile_URL,\n  Local_Storage_Key,\n} from '../utilities/constants';\nimport Articles from './Articles';\nimport Pagination from './Pagination';\nimport { withRouter, Link } from 'react-router-dom';\nimport UserContext from '../context/UserContext';\n\nfunction Profile(props) {\n  const [state, setState] = useState({\n    user: '',\n    articles: null,\n    articlesCount: null,\n    articlesPerPage: 10,\n    activePageIndex: 1,\n    feedSelected: 'author',\n    following: '',\n    favoriteCount: 0,\n    error: '',\n  });\n  const info = useContext(UserContext);\n\n  const id = props.match.params.id;\n  useEffect(() => {\n    function getUserInfo(id) {\n      fetch(Profile_URL + id, {\n        method: 'GET',\n        headers: {\n          Authorization: 'Bearer ' + localStorage[Local_Storage_Key],\n        },\n      })\n        .then((res) => {\n          if (!res.ok) {\n            return res.json().then(({ errors }) => {\n              return Promise.reject();\n            });\n          }\n          return res.json();\n        })\n        .then((data) => {\n          let profile = data.profile;\n          setState((state) => {\n            return { ...state, user: profile, following: profile.following };\n          });\n        })\n        .catch((err) => console.log(err));\n    }\n    getUserInfo(id);\n  }, [id]);\n\n  var feedUser = state.user.username;\n  useEffect(() => {\n    let offset = (state.activePageIndex - 1) * 10;\n    let token = localStorage[Local_Storage_Key];\n    if (feedUser) {\n      fetch(\n        `${Articles_URL}?${state.feedSelected}=${feedUser}&limit=${state.articlesPerPage}&offset=${offset}`,\n        {\n          method: 'GET',\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-type': 'application/json',\n          },\n        }\n      )\n        .then((res) => {\n          if (!res.ok) {\n            throw new Error(res.statusText);\n          }\n          return res.json();\n        })\n        .then((data) => {\n          setState((state) => {\n            return {\n              ...state,\n              articles: data.articles,\n              articlesCount: data.articlesCount,\n            };\n          });\n        })\n        .catch((err) => {\n          setState((state) => {\n            return { ...state, error: 'Not able to fetch Articles' };\n          });\n        });\n    }\n  }, [\n    feedUser,\n    state.feedSelected,\n    state.activePageIndex,\n    state.articlesPerPage,\n    state.favoriteCount,\n  ]);\n\n  function handleClick({ target }) {\n    let { id } = target.dataset;\n    setState({ ...state, activePageIndex: id });\n  }\n\n  function updateCurrentPageIndex(index) {\n    setState({ ...state, activePageIndex: index });\n  }\n\n  function handleFollow() {\n    // getUserInfo();\n    let { username } = state.user;\n    let { following } = state;\n    let method = following ? 'DELETE' : 'POST';\n    fetch(Profile_URL + '/' + username + '/follow', {\n      method: method,\n      headers: {\n        Authorization: 'Bearer ' + localStorage[Local_Storage_Key],\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          return res.json().then(({ errors }) => {\n            return Promise.reject();\n          });\n        }\n        return res.json();\n      })\n      .then(({ profile }) => {\n        // console.log(profile);\n        setState({ ...state, following: profile.following });\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleFavorite({ target }) {\n    let { id, slug, count } = target.dataset;\n    let method = id === 'false' ? 'POST' : 'DELETE';\n    fetch(Articles_URL + '/' + slug + '/favorite', {\n      method: method,\n      headers: {\n        Authorization: 'Token ' + localStorage[Local_Storage_Key],\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          return res.json().then(({ errors }) => {\n            return Promise.reject(errors);\n          });\n        }\n        return res.json();\n      })\n      .then((data) => {\n        // getFeedArticles();\n        setState({ ...state, favoriteCount: count + 1 });\n      })\n      .catch((err) => console.log(err));\n  }\n\n  if (!state.user) {\n    return <Loader />;\n  }\n  let { username, image, bio } = state.user;\n  // let loggedInUser = this.props?.user?.username;\n  let loggedInUser = info.data?.user?.username;\n  let {\n    articles,\n    error,\n    articlesCount,\n    activePageIndex,\n    articlesPerPage,\n    feedSelected,\n    following,\n  } = state;\n  return (\n    <main>\n      <section>\n        <div className=\"bg-indigo-200 text-white py-16 text-center\">\n          <img\n            src={image}\n            alt={username}\n            className=\"w-40 h-40 rounded-full mx-auto\"\n          />\n          <h2 className=\"text-4xl my-4 text-gray-700\">{username}</h2>\n          <h3 className=\"text-2xl text-gray-500 mb-5\">{bio}</h3>\n          <div className=\"float-right mr-10 \">\n            {loggedInUser && loggedInUser !== username && (\n              <button\n                className=\"bg-gray-200 text-gray-700 btn rounded-full hover:bg-gray-300 transform transition duration-500 hover:scale-105\"\n                onClick={handleFollow}\n              >\n                <i\n                  className={\n                    !following ? 'fas fa-plus mr-2' : 'fas fa-minus mr-2'\n                  }\n                ></i>\n                {!following ? 'follow' : 'unfollow'}\n              </button>\n            )}\n            {loggedInUser && loggedInUser === username && (\n              <Link\n                to=\"/settings\"\n                className=\"btn bg-gray-200 text-gray-600 hover:bg-gray-300\"\n              >\n                <i className=\"fas fa-user-edit mr-2\"></i>Edit Profile\n              </Link>\n            )}\n          </div>\n        </div>\n\n        <article className=\"px-40\">\n          <div className=\"py-6\">\n            <span\n              className={\n                feedSelected === 'author'\n                  ? 'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500'\n                  : 'cursor-pointer text-xl text-gray-700'\n              }\n              onClick={() => {\n                setState({\n                  ...state,\n                  feedSelected: 'author',\n                  activePageIndex: 1,\n                });\n                // getFeedArticles();\n              }}\n            >\n              <i className=\"fas fa-newspaper mr-2\"></i>\n              Articles written\n            </span>\n            <span className=\"mx-4\">/</span>\n            <span\n              className={\n                feedSelected === 'favorited'\n                  ? 'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500'\n                  : 'cursor-pointer text-xl text-gray-700'\n              }\n              onClick={() => {\n                setState({\n                  ...state,\n                  feedSelected: 'favorited',\n                  activePageIndex: 1,\n                });\n                // getFeedArticles();\n              }}\n            >\n              <i className=\"fas fa-newspaper mr-2\"></i>\n              Favorited\n            </span>\n          </div>\n          <div className=\"\">\n            <Articles\n              articles={articles}\n              error={error}\n              isLoggedIn={info.data.isLoggedIn}\n              handleFavorite={handleFavorite}\n            />\n          </div>\n        </article>\n        <div className=\"text-center py-8 flex justify-center\">\n          <Pagination\n            articlesCount={articlesCount}\n            articlesPerPage={articlesPerPage}\n            activePageIndex={activePageIndex}\n            handleClick={handleClick}\n            updateCurrentPageIndex={updateCurrentPageIndex}\n          />\n        </div>\n      </section>\n    </main>\n  );\n}\n\nexport default withRouter(Profile);\n"]},"metadata":{},"sourceType":"module"}