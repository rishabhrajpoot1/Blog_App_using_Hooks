{"ast":null,"code":"import _slicedToArray from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import Articles from'./Articles';import Tags from'./Tags';import{Articles_URL,Feed_URL,Local_Storage_Key}from'../utilities/constants';import Pagiantion from'./Pagination';import UserContext from'../context/UserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ArticlesHome(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),articles=_useState2[0],setArticles=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),articlesCount=_useState6[0],setArticlesCount=_useState6[1];var _useState7=useState(10),_useState8=_slicedToArray(_useState7,1),articlesPerPage=_useState8[0];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),activePageIndex=_useState10[0],setActivePageIndex=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),tagSelected=_useState12[0],setTagSelected=_useState12[1];var _useState13=useState(Articles_URL),_useState14=_slicedToArray(_useState13,2),url=_useState14[0],setUrl=_useState14[1];var info=useContext(UserContext);var isLoggedIn=info.data.isLoggedIn;function getArticles(url,activePageIndex,articlesPerPage,tagSelected){var token=localStorage[Local_Storage_Key];fetch(url+\"/?offset=\".concat((activePageIndex-1)*10,\"&limit=\").concat(articlesPerPage)+(tagSelected&&\"&tag=\".concat(tagSelected)),{method:'GET',headers:{Authorization:\"Bearer \".concat(token),'Content-type':'application/json'}}).then(function(res){if(!res.ok){throw new Error(res.statusText);}return res.json();}).then(function(data){setArticles(data.articles);setArticlesCount(data.articlesCount);}).catch(function(err){setError('Not able to fetch Articles');});}useEffect(function(){getArticles(url,activePageIndex,articlesPerPage,tagSelected);return function(){};},[url,activePageIndex,articlesPerPage,tagSelected]);function updateCurrentPageIndex(index){setActivePageIndex(index);setTagSelected('');}function selectTag(_ref){var target=_ref.target;var value=target.dataset.value;setTagSelected(value);setActivePageIndex(1);setUrl(Articles_URL);}function handleFavorite(_ref2){var target=_ref2.target;var _target$dataset=target.dataset,id=_target$dataset.id,slug=_target$dataset.slug;var method=id==='false'?'POST':'DELETE';if(isLoggedIn){fetch(Articles_URL+'/'+slug+'/favorite',{method:method,headers:{Authorization:'Token '+localStorage[Local_Storage_Key]}}).then(function(res){if(!res.ok){return res.json().then(function(_ref3){var errors=_ref3.errors;return Promise.reject(errors);});}return res.json();}).then(function(data){if(url===Feed_URL){getArticles(Feed_URL,activePageIndex,articlesPerPage,tagSelected);}else{getArticles(Articles_URL,activePageIndex,articlesPerPage,tagSelected);}}).catch(function(err){return console.log(err);});}}return/*#__PURE__*/ (// Hero section\n_jsxs(\"main\",{className:\"px-24 py-16 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex mb-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:url===Articles_URL?'cursor-pointer mr-8 text-xl text-green-500':'cursor-pointer mr-8 text-xl text-gray-600',onClick:function onClick(){setTagSelected('');setUrl(Articles_URL);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-newspaper mr-2\"}),\"Global Feed\"]}),isLoggedIn&&/*#__PURE__*/_jsxs(\"span\",{className:url===Feed_URL?'text-xl mr-8 cursor-pointer text-green-500':'text-xl  cursor-pointer text-gray-600',onClick:function onClick(){setTagSelected('');setUrl(Feed_URL);setActivePageIndex(1);},children:[' ',/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-newspaper mr-2\"}),\"My feed\"]}),tagSelected&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mx-2 text-gray-500\",children:\"/\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-700\",children:[\"#\",tagSelected]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"flex justify-between \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-4/6\",children:/*#__PURE__*/_jsx(Articles,{articles:articles,error:error,handleFavorite:handleFavorite})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-80\",children:/*#__PURE__*/_jsx(Tags,{selectTag:selectTag})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-10\",children:/*#__PURE__*/_jsx(Pagiantion,{articlesCount:articlesCount,articlesPerPage:articlesPerPage,activePageIndex:activePageIndex,updateCurrentPageIndex:updateCurrentPageIndex})})]}));}export default ArticlesHome;","map":{"version":3,"sources":["/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/src/components/ArticlesHome.js"],"names":["React","useState","useEffect","useContext","Articles","Tags","Articles_URL","Feed_URL","Local_Storage_Key","Pagiantion","UserContext","ArticlesHome","props","articles","setArticles","error","setError","articlesCount","setArticlesCount","articlesPerPage","activePageIndex","setActivePageIndex","tagSelected","setTagSelected","url","setUrl","info","isLoggedIn","data","getArticles","token","localStorage","fetch","method","headers","Authorization","then","res","ok","Error","statusText","json","catch","err","updateCurrentPageIndex","index","selectTag","target","value","dataset","handleFavorite","id","slug","errors","Promise","reject","console","log"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport Articles from './Articles';\nimport Tags from './Tags';\nimport {\n  Articles_URL,\n  Feed_URL,\n  Local_Storage_Key,\n} from '../utilities/constants';\nimport Pagiantion from './Pagination';\nimport UserContext from '../context/UserContext';\n\nfunction ArticlesHome(props) {\n  const [articles, setArticles] = useState(null);\n  const [error, setError] = useState('');\n  const [articlesCount, setArticlesCount] = useState(0);\n  const [articlesPerPage] = useState(10);\n  const [activePageIndex, setActivePageIndex] = useState(1);\n  const [tagSelected, setTagSelected] = useState('');\n  const [url, setUrl] = useState(Articles_URL);\n  const info = useContext(UserContext);\n  let { isLoggedIn } = info.data;\n\n  function getArticles(url, activePageIndex, articlesPerPage, tagSelected) {\n    let token = localStorage[Local_Storage_Key];\n    fetch(\n      url +\n        `/?offset=${(activePageIndex - 1) * 10}&limit=${articlesPerPage}` +\n        (tagSelected && `&tag=${tagSelected}`),\n      {\n        method: 'GET',\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-type': 'application/json',\n        },\n      }\n    )\n      .then((res) => {\n        if (!res.ok) {\n          throw new Error(res.statusText);\n        }\n        return res.json();\n      })\n      .then((data) => {\n        setArticles(data.articles);\n        setArticlesCount(data.articlesCount);\n      })\n      .catch((err) => {\n        setError('Not able to fetch Articles');\n      });\n  }\n\n  useEffect(() => {\n    getArticles(url, activePageIndex, articlesPerPage, tagSelected);\n    return () => {};\n  }, [url, activePageIndex, articlesPerPage, tagSelected]);\n\n  function updateCurrentPageIndex(index) {\n    setActivePageIndex(index);\n    setTagSelected('');\n  }\n\n  function selectTag({ target }) {\n    let { value } = target.dataset;\n    setTagSelected(value);\n    setActivePageIndex(1);\n    setUrl(Articles_URL);\n  }\n\n  function handleFavorite({ target }) {\n    let { id, slug } = target.dataset;\n    let method = id === 'false' ? 'POST' : 'DELETE';\n    if (isLoggedIn) {\n      fetch(Articles_URL + '/' + slug + '/favorite', {\n        method: method,\n        headers: {\n          Authorization: 'Token ' + localStorage[Local_Storage_Key],\n        },\n      })\n        .then((res) => {\n          if (!res.ok) {\n            return res.json().then(({ errors }) => {\n              return Promise.reject(errors);\n            });\n          }\n          return res.json();\n        })\n        .then((data) => {\n          if (url === Feed_URL) {\n            getArticles(\n              Feed_URL,\n              activePageIndex,\n              articlesPerPage,\n              tagSelected\n            );\n          } else {\n            getArticles(\n              Articles_URL,\n              activePageIndex,\n              articlesPerPage,\n              tagSelected\n            );\n          }\n        })\n        .catch((err) => console.log(err));\n    }\n  }\n\n  return (\n    // Hero section\n    <main className=\"px-24 py-16 w-full\">\n      {/* feeds part */}\n      <div className=\"flex mb-3\">\n        <span\n          className={\n            url === Articles_URL\n              ? 'cursor-pointer mr-8 text-xl text-green-500'\n              : 'cursor-pointer mr-8 text-xl text-gray-600'\n          }\n          onClick={() => {\n            setTagSelected('');\n            setUrl(Articles_URL);\n          }}\n        >\n          <i className=\"fas fa-newspaper mr-2\"></i>\n          Global Feed\n        </span>\n        {isLoggedIn && (\n          <span\n            className={\n              url === Feed_URL\n                ? 'text-xl mr-8 cursor-pointer text-green-500'\n                : 'text-xl  cursor-pointer text-gray-600'\n            }\n            onClick={() => {\n              setTagSelected('');\n              setUrl(Feed_URL);\n              setActivePageIndex(1);\n            }}\n          >\n            {' '}\n            <i className=\"fas fa-newspaper mr-2\"></i>\n            My feed\n          </span>\n        )}\n\n        {tagSelected && (\n          <div className=\"text-xl\">\n            <span className=\"mx-2 text-gray-500\">/</span>\n            <span className=\"text-green-700\">#{tagSelected}</span>\n          </div>\n        )}\n      </div>\n\n      {/* articles part */}\n      <section className=\"flex justify-between \">\n        <div className=\"w-4/6\">\n          <Articles\n            articles={articles}\n            error={error}\n            handleFavorite={handleFavorite}\n          />\n        </div>\n\n        {/* tags part */}\n        <div className=\"w-80\">\n          <Tags selectTag={selectTag} />\n        </div>\n        {/* Pagination */}\n      </section>\n      <div className=\"mt-10\">\n        <Pagiantion\n          articlesCount={articlesCount}\n          articlesPerPage={articlesPerPage}\n          activePageIndex={activePageIndex}\n          updateCurrentPageIndex={updateCurrentPageIndex}\n        />\n      </div>\n    </main>\n  );\n}\n\nexport default ArticlesHome;\n"]},"metadata":{},"sourceType":"module"}