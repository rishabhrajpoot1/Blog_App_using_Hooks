{"ast":null,"code":"import _defineProperty from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{validations}from'../utilities/validations';import{Local_Storage_Key,User_Verify_URL}from'../utilities/constants';import{withRouter}from'react-router';import Loader from'./Loader';import UserContext from\"../context/UserContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Settings(props){// constructor(props) {\n//   super();\n//   state = {\n//     image: \"\",\n//     username: \"\",\n//     email: \"\",\n//     password: '',\n//     bio: \"\",\n//     errors: {\n//       username: '',\n//       email: '',\n//       password: '',\n//     },\n//   };\n// }\nvar _useState=useState({image:\"\",username:\"\",password:'',bio:\"\",errors:{username:'',password:''}}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var info=useContext(UserContext);useEffect(function(){var _info$data$user=info.data.user,image=_info$data$user.image,username=_info$data$user.username,bio=_info$data$user.bio;setState(function(state){return _objectSpread(_objectSpread({},state),{},{image:image,username:username,bio:bio});});},[info.data]);function handleChange(_ref){var _objectSpread2;var target=_ref.target;var name=target.name,value=target.value;var errors=state.errors;validations(errors,name,value);setState(_objectSpread(_objectSpread({},state),{},(_objectSpread2={},_defineProperty(_objectSpread2,name,value),_defineProperty(_objectSpread2,\"errors\",errors),_objectSpread2)));};function handleSubmit(event){var username=state.username,image=state.image,password=state.password,bio=state.bio,errors=state.errors;event.preventDefault();if(username&&image&&password&&bio){fetch(User_Verify_URL,{method:'PUT',body:JSON.stringify({user:{username:username,password:password,bio:bio,image:image}}),headers:{'Content-Type':'application/json',Authorization:'Bearer '+localStorage[Local_Storage_Key]}}).then(function(res){// console.log(res);\nif(!res.ok){return res.json().then(function(data){for(var key in data.errors){errors[key]=\"\".concat(key,\" \").concat(data.errors[key]);}return Promise.reject({errors:errors});});}return res.json();}).then(function(data){props.history.push(\"/profiles/\".concat(data.user.username));}).catch(function(err){return setState(_objectSpread(_objectSpread({},state),{},{errors:errors}));});}};if(!state.username&&!state.image&&!state.bio){return/*#__PURE__*/_jsx(Loader,{});}var _state$errors=state.errors,username=_state$errors.username,password=_state$errors.password;return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsx(\"section\",{className:\"py-20\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"w-1/2 mx-auto p-8 border border-gray-400 rounded-md\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"legend\",{className:\"text-center text-3xl my-2 font-bold\",children:\"Settings\"}),/*#__PURE__*/_jsxs(\"fieldset\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Image Url\",value:state.image,onChange:handleChange,name:\"image\",className:\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:state.username,onChange:handleChange,className:\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"my-1 text-red-500\",children:username}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:state.password,placeholder:\"Password\",onChange:handleChange,className:\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"my-1 text-red-500\",children:password}),/*#__PURE__*/_jsx(\"textarea\",{value:state.bio,rows:\"6\",name:\"bio\",placeholder:\"Enter your Bio\",onChange:handleChange,className:\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Update\",className:\"btn btn-green\"})]})]})})});};export default withRouter(Settings);","map":{"version":3,"sources":["/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/src/components/Settings.js"],"names":["React","useState","useEffect","useContext","validations","Local_Storage_Key","User_Verify_URL","withRouter","Loader","UserContext","Settings","props","image","username","password","bio","errors","state","setState","info","data","user","handleChange","target","name","value","handleSubmit","event","preventDefault","fetch","method","body","JSON","stringify","headers","Authorization","localStorage","then","res","ok","json","key","Promise","reject","history","push","catch","err"],"mappings":"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","sourcesContent":["import React,{useState, useEffect,useContext} from 'react';\nimport { validations } from '../utilities/validations';\nimport { Local_Storage_Key, User_Verify_URL } from '../utilities/constants';\nimport { withRouter } from 'react-router';\nimport Loader from './Loader';\nimport UserContext from \"../context/UserContext\";\n\nfunction Settings (props) {\n  // constructor(props) {\n  //   super();\n  //   state = {\n  //     image: \"\",\n  //     username: \"\",\n  //     email: \"\",\n  //     password: '',\n  //     bio: \"\",\n  //     errors: {\n  //       username: '',\n  //       email: '',\n  //       password: '',\n  //     },\n  //   };\n  // }\n  const [state, setState] = useState({\n      image: \"\",\n      username: \"\",\n      password: '',\n      bio: \"\",\n      errors: {\n        username: '',\n        password: '',\n      },\n  })\n  const info = useContext(UserContext);\n\n  useEffect(() => {\n      let {image, username, bio} = info.data.user;\n      setState(state => {\n        return {...state, image, username, bio}}\n  )}, [info.data])\n\n  function handleChange ({ target }) {\n    let { name, value } = target;\n    let  errors  = state.errors;\n    validations(errors, name, value);\n    setState({...state, [name]: value, errors });\n  };\n\n  function handleSubmit (event) {\n    let { username, image, password, bio, errors } = state;\n    event.preventDefault();\n    if (username && image && password && bio) {\n      fetch(User_Verify_URL, {\n        method: 'PUT',\n        body: JSON.stringify({\n          user: { username, password, bio, image },\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + localStorage[Local_Storage_Key],\n        },\n      })\n        .then((res) => {\n          // console.log(res);\n          if (!res.ok) {\n            return res.json().then((data) => {\n              for (let key in data.errors) {\n                errors[key] = `${key} ${data.errors[key]}`;\n              }\n              return Promise.reject({ errors });\n            });\n          }\n          return res.json();\n        })\n        .then((data) => {\n          props.history.push(`/profiles/${data.user.username}`);\n        })\n        .catch((err) => setState({...state, errors }));\n    }\n  };\n\n    if(!state.username && !state.image && !state.bio) {\n      return < Loader />\n  }\n    let { username, password } = state.errors;\n\n    return (\n      <main>\n        <section className=\"py-20\">\n          <form\n            className=\"w-1/2 mx-auto p-8 border border-gray-400 rounded-md\"\n            onSubmit={handleSubmit}\n          >\n            <legend className=\"text-center text-3xl my-2 font-bold\">\n              Settings\n            </legend>\n            <fieldset className=\"flex flex-col\">\n              <input\n                type=\"text\"\n                placeholder=\"Image Url\"\n                value={state.image}\n                onChange={handleChange}\n                name=\"image\"\n                className=\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"\n              />\n\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={state.username}\n                onChange={handleChange}\n                className=\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"\n              />\n              <span className=\"my-1 text-red-500\">{username}</span>\n\n              <input\n                type=\"password\"\n                name=\"password\"\n                value={state.password}\n                placeholder=\"Password\"\n                onChange={handleChange}\n                className=\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"\n              />\n              <span className=\"my-1 text-red-500\">{password}</span>\n\n              <textarea\n                value={state.bio}\n                rows=\"6\"\n                name=\"bio\"\n                placeholder=\"Enter your Bio\"\n                onChange={handleChange}\n                className=\"my-2 p-2 rounded-md outline-none border-2 border-gray-300 focus:border-blue-500\"\n              ></textarea>\n\n              <input\n                type=\"submit\"\n                value=\"Update\"\n                className=\"btn btn-green\"\n              ></input>\n            </fieldset>\n          </form>\n        </section>\n      </main>\n    );\n  };\n\nexport default withRouter(Settings);\n"]},"metadata":{},"sourceType":"module"}