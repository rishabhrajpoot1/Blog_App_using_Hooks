{"ast":null,"code":"var _jsxFileName = \"/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/src/components/Profile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport Loader from './Loader';\nimport { Articles_URL, Profile_URL, Local_Storage_Key } from '../utilities/constants';\nimport Articles from './Articles';\nimport Pagination from './Pagination';\nimport { withRouter, Link } from 'react-router-dom';\nimport UserContext from '../context/UserContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Profile(props) {\n  _s();\n\n  var _info$data, _info$data$user;\n\n  const [state, setState] = useState({\n    user: '',\n    articles: null,\n    articlesCount: null,\n    articlesPerPage: 10,\n    activePageIndex: 1,\n    feedSelected: 'author',\n    following: '',\n    favoriteCount: 0,\n    error: ''\n  });\n  const info = useContext(UserContext);\n  const id = props.match.params.id;\n  useEffect(() => {\n    function getUserInfo(id) {\n      fetch(Profile_URL + id, {\n        method: 'GET',\n        headers: {\n          Authorization: 'Bearer ' + localStorage[Local_Storage_Key]\n        }\n      }).then(res => {\n        if (!res.ok) {\n          return res.json().then(({\n            errors\n          }) => {\n            return Promise.reject();\n          });\n        }\n\n        return res.json();\n      }).then(data => {\n        let profile = data.profile;\n        setState(state => {\n          return { ...state,\n            user: profile,\n            following: profile.following\n          };\n        });\n      }).catch(err => console.log(err));\n    }\n\n    getUserInfo(id);\n  }, [id]);\n  var feedUser = state.user.username;\n  useEffect(() => {\n    let offset = (state.activePageIndex - 1) * 10;\n    let token = localStorage[Local_Storage_Key];\n\n    if (feedUser) {\n      fetch(`${Articles_URL}?${state.feedSelected}=${feedUser}&limit=${state.articlesPerPage}&offset=${offset}`, {\n        method: 'GET',\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-type': 'application/json'\n        }\n      }).then(res => {\n        if (!res.ok) {\n          throw new Error(res.statusText);\n        }\n\n        return res.json();\n      }).then(data => {\n        setState(state => {\n          return { ...state,\n            articles: data.articles,\n            articlesCount: data.articlesCount\n          };\n        });\n      }).catch(err => {\n        setState(state => {\n          return { ...state,\n            error: 'Not able to fetch Articles'\n          };\n        });\n      });\n    }\n  }, [feedUser, state.feedSelected, state.activePageIndex, state.articlesPerPage, state.favoriteCount]);\n\n  function handleClick({\n    target\n  }) {\n    let {\n      id\n    } = target.dataset;\n    setState({ ...state,\n      activePageIndex: id\n    });\n  }\n\n  function updateCurrentPageIndex(index) {\n    setState({ ...state,\n      activePageIndex: index\n    });\n  }\n\n  function handleFollow() {\n    // getUserInfo();\n    let {\n      username\n    } = state.user;\n    let {\n      following\n    } = state;\n    let method = following ? 'DELETE' : 'POST';\n    fetch(Profile_URL + '/' + username + '/follow', {\n      method: method,\n      headers: {\n        Authorization: 'Bearer ' + localStorage[Local_Storage_Key]\n      }\n    }).then(res => {\n      if (!res.ok) {\n        return res.json().then(({\n          errors\n        }) => {\n          return Promise.reject();\n        });\n      }\n\n      return res.json();\n    }).then(({\n      profile\n    }) => {\n      // console.log(profile);\n      setState({ ...state,\n        following: profile.following\n      });\n    }).catch(err => console.log(err));\n  }\n\n  function handleFavorite({\n    target\n  }) {\n    let {\n      id,\n      slug,\n      count\n    } = target.dataset;\n    let method = id === 'false' ? 'POST' : 'DELETE';\n    fetch(Articles_URL + '/' + slug + '/favorite', {\n      method: method,\n      headers: {\n        Authorization: 'Token ' + localStorage[Local_Storage_Key]\n      }\n    }).then(res => {\n      if (!res.ok) {\n        return res.json().then(({\n          errors\n        }) => {\n          return Promise.reject(errors);\n        });\n      }\n\n      return res.json();\n    }).then(data => {\n      // getFeedArticles();\n      setState({ ...state,\n        favoriteCount: count + 1\n      });\n    }).catch(err => console.log(err));\n  }\n\n  if (!state.user) {\n    return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 12\n    }, this);\n  }\n\n  let {\n    username,\n    image,\n    bio\n  } = state.user; // let loggedInUser = this.props?.user?.username;\n\n  let loggedInUser = (_info$data = info.data) === null || _info$data === void 0 ? void 0 : (_info$data$user = _info$data.user) === null || _info$data$user === void 0 ? void 0 : _info$data$user.username;\n  let {\n    articles,\n    error,\n    articlesCount,\n    activePageIndex,\n    articlesPerPage,\n    feedSelected,\n    following\n  } = state;\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: /*#__PURE__*/_jsxDEV(\"section\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-indigo-200 text-white py-16 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: image,\n          alt: username,\n          className: \"w-40 h-40 rounded-full mx-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-4xl my-4 text-gray-700\",\n          children: username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-2xl text-gray-500 mb-5\",\n          children: bio\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"float-right mr-10 \",\n          children: [loggedInUser && loggedInUser !== username && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"bg-gray-200 text-gray-700 btn rounded-full hover:bg-gray-300 transform transition duration-500 hover:scale-105\",\n            onClick: handleFollow,\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: !following ? 'fas fa-plus mr-2' : 'fas fa-minus mr-2'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 17\n            }, this), !following ? 'follow' : 'unfollow']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this), loggedInUser && loggedInUser === username && /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/settings\",\n            className: \"btn bg-gray-200 text-gray-600 hover:bg-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-user-edit mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 17\n            }, this), \"Edit Profile\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n        className: \"px-40\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"py-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: feedSelected === 'author' ? 'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500' : 'cursor-pointer text-xl text-gray-700',\n            onClick: () => {\n              setState({ ...state,\n                feedSelected: 'author',\n                activePageIndex: 1\n              }); // getFeedArticles();\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-newspaper mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this), \"Articles written\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mx-4\",\n            children: \"/\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: feedSelected === 'favorited' ? 'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500' : 'cursor-pointer text-xl text-gray-700',\n            onClick: () => {\n              setState({ ...state,\n                feedSelected: 'favorited',\n                activePageIndex: 1\n              }); // getFeedArticles();\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-newspaper mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this), \"Favorited\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: /*#__PURE__*/_jsxDEV(Articles, {\n            articles: articles,\n            error: error,\n            isLoggedIn: info.data.isLoggedIn,\n            handleFavorite: handleFavorite\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-8 flex justify-center\",\n        children: /*#__PURE__*/_jsxDEV(Pagination, {\n          articlesCount: articlesCount,\n          articlesPerPage: articlesPerPage,\n          activePageIndex: activePageIndex,\n          handleClick: handleClick,\n          updateCurrentPageIndex: updateCurrentPageIndex\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Profile, \"tmzYCX8DhDVH9coHrqqaKXK2S2g=\");\n\n_c = Profile;\nexport default _c2 = withRouter(Profile);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Profile\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/rishabh/Desktop/AltCampus/Advanced React/Blog_App_using_Hooks/blog-app-using-hooks/src/components/Profile.js"],"names":["React","useState","useEffect","useContext","Loader","Articles_URL","Profile_URL","Local_Storage_Key","Articles","Pagination","withRouter","Link","UserContext","Profile","props","state","setState","user","articles","articlesCount","articlesPerPage","activePageIndex","feedSelected","following","favoriteCount","error","info","id","match","params","getUserInfo","fetch","method","headers","Authorization","localStorage","then","res","ok","json","errors","Promise","reject","data","profile","catch","err","console","log","feedUser","username","offset","token","Error","statusText","handleClick","target","dataset","updateCurrentPageIndex","index","handleFollow","handleFavorite","slug","count","image","bio","loggedInUser","isLoggedIn"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport Loader from './Loader';\nimport {\n  Articles_URL,\n  Profile_URL,\n  Local_Storage_Key,\n} from '../utilities/constants';\nimport Articles from './Articles';\nimport Pagination from './Pagination';\nimport { withRouter, Link } from 'react-router-dom';\nimport UserContext from '../context/UserContext';\n\nfunction Profile(props) {\n  const [state, setState] = useState({\n    user: '',\n    articles: null,\n    articlesCount: null,\n    articlesPerPage: 10,\n    activePageIndex: 1,\n    feedSelected: 'author',\n    following: '',\n    favoriteCount: 0,\n    error: '',\n  });\n  const info = useContext(UserContext);\n\n  const id = props.match.params.id;\n  useEffect(() => {\n    function getUserInfo(id) {\n      fetch(Profile_URL + id, {\n        method: 'GET',\n        headers: {\n          Authorization: 'Bearer ' + localStorage[Local_Storage_Key],\n        },\n      })\n        .then((res) => {\n          if (!res.ok) {\n            return res.json().then(({ errors }) => {\n              return Promise.reject();\n            });\n          }\n          return res.json();\n        })\n        .then((data) => {\n          let profile = data.profile;\n          setState((state) => {\n            return { ...state, user: profile, following: profile.following };\n          });\n        })\n        .catch((err) => console.log(err));\n    }\n    getUserInfo(id);\n  }, [id]);\n\n  var feedUser = state.user.username;\n  useEffect(() => {\n    let offset = (state.activePageIndex - 1) * 10;\n    let token = localStorage[Local_Storage_Key];\n    if (feedUser) {\n      fetch(\n        `${Articles_URL}?${state.feedSelected}=${feedUser}&limit=${state.articlesPerPage}&offset=${offset}`,\n        {\n          method: 'GET',\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-type': 'application/json',\n          },\n        }\n      )\n        .then((res) => {\n          if (!res.ok) {\n            throw new Error(res.statusText);\n          }\n          return res.json();\n        })\n        .then((data) => {\n          setState((state) => {\n            return {\n              ...state,\n              articles: data.articles,\n              articlesCount: data.articlesCount,\n            };\n          });\n        })\n        .catch((err) => {\n          setState((state) => {\n            return { ...state, error: 'Not able to fetch Articles' };\n          });\n        });\n    }\n  }, [\n    feedUser,\n    state.feedSelected,\n    state.activePageIndex,\n    state.articlesPerPage,\n    state.favoriteCount,\n  ]);\n\n  function handleClick({ target }) {\n    let { id } = target.dataset;\n    setState({ ...state, activePageIndex: id });\n  }\n\n  function updateCurrentPageIndex(index) {\n    setState({ ...state, activePageIndex: index });\n  }\n\n  function handleFollow() {\n    // getUserInfo();\n    let { username } = state.user;\n    let { following } = state;\n    let method = following ? 'DELETE' : 'POST';\n    fetch(Profile_URL + '/' + username + '/follow', {\n      method: method,\n      headers: {\n        Authorization: 'Bearer ' + localStorage[Local_Storage_Key],\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          return res.json().then(({ errors }) => {\n            return Promise.reject();\n          });\n        }\n        return res.json();\n      })\n      .then(({ profile }) => {\n        // console.log(profile);\n        setState({ ...state, following: profile.following });\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleFavorite({ target }) {\n    let { id, slug, count } = target.dataset;\n    let method = id === 'false' ? 'POST' : 'DELETE';\n    fetch(Articles_URL + '/' + slug + '/favorite', {\n      method: method,\n      headers: {\n        Authorization: 'Token ' + localStorage[Local_Storage_Key],\n      },\n    })\n      .then((res) => {\n        if (!res.ok) {\n          return res.json().then(({ errors }) => {\n            return Promise.reject(errors);\n          });\n        }\n        return res.json();\n      })\n      .then((data) => {\n        // getFeedArticles();\n        setState({ ...state, favoriteCount: count + 1 });\n      })\n      .catch((err) => console.log(err));\n  }\n\n  if (!state.user) {\n    return <Loader />;\n  }\n  let { username, image, bio } = state.user;\n  // let loggedInUser = this.props?.user?.username;\n  let loggedInUser = info.data?.user?.username;\n  let {\n    articles,\n    error,\n    articlesCount,\n    activePageIndex,\n    articlesPerPage,\n    feedSelected,\n    following,\n  } = state;\n  return (\n    <main>\n      <section>\n        <div className=\"bg-indigo-200 text-white py-16 text-center\">\n          <img\n            src={image}\n            alt={username}\n            className=\"w-40 h-40 rounded-full mx-auto\"\n          />\n          <h2 className=\"text-4xl my-4 text-gray-700\">{username}</h2>\n          <h3 className=\"text-2xl text-gray-500 mb-5\">{bio}</h3>\n          <div className=\"float-right mr-10 \">\n            {loggedInUser && loggedInUser !== username && (\n              <button\n                className=\"bg-gray-200 text-gray-700 btn rounded-full hover:bg-gray-300 transform transition duration-500 hover:scale-105\"\n                onClick={handleFollow}\n              >\n                <i\n                  className={\n                    !following ? 'fas fa-plus mr-2' : 'fas fa-minus mr-2'\n                  }\n                ></i>\n                {!following ? 'follow' : 'unfollow'}\n              </button>\n            )}\n            {loggedInUser && loggedInUser === username && (\n              <Link\n                to=\"/settings\"\n                className=\"btn bg-gray-200 text-gray-600 hover:bg-gray-300\"\n              >\n                <i className=\"fas fa-user-edit mr-2\"></i>Edit Profile\n              </Link>\n            )}\n          </div>\n        </div>\n\n        <article className=\"px-40\">\n          <div className=\"py-6\">\n            <span\n              className={\n                feedSelected === 'author'\n                  ? 'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500'\n                  : 'cursor-pointer text-xl text-gray-700'\n              }\n              onClick={() => {\n                setState({\n                  ...state,\n                  feedSelected: 'author',\n                  activePageIndex: 1,\n                });\n                // getFeedArticles();\n              }}\n            >\n              <i className=\"fas fa-newspaper mr-2\"></i>\n              Articles written\n            </span>\n            <span className=\"mx-4\">/</span>\n            <span\n              className={\n                feedSelected === 'favorited'\n                  ? 'cursor-pointer text-xl text-green-500 pb-2 border-b-2 border-green-500'\n                  : 'cursor-pointer text-xl text-gray-700'\n              }\n              onClick={() => {\n                setState({\n                  ...state,\n                  feedSelected: 'favorited',\n                  activePageIndex: 1,\n                });\n                // getFeedArticles();\n              }}\n            >\n              <i className=\"fas fa-newspaper mr-2\"></i>\n              Favorited\n            </span>\n          </div>\n          <div className=\"\">\n            <Articles\n              articles={articles}\n              error={error}\n              isLoggedIn={info.data.isLoggedIn}\n              handleFavorite={handleFavorite}\n            />\n          </div>\n        </article>\n        <div className=\"text-center py-8 flex justify-center\">\n          <Pagination\n            articlesCount={articlesCount}\n            articlesPerPage={articlesPerPage}\n            activePageIndex={activePageIndex}\n            handleClick={handleClick}\n            updateCurrentPageIndex={updateCurrentPageIndex}\n          />\n        </div>\n      </section>\n    </main>\n  );\n}\n\nexport default withRouter(Profile);\n"]},"metadata":{},"sourceType":"module"}